# 5.0.0 to 5.1.0

## 5.0.0 to 5.1.0

#### Overview <a href="#user-content-overview" id="user-content-overview"></a>

This page details out the jobs required to be run as part of the upgrade from Sunbird and Vidaydaan release 5.0.0 to release 5.1.0. Use the following table to understand the jobs that need to be executed in order to successfully complete the upgrade. Any jenkins job configuration or pre-requisites mentioned under manual configuration section needs to be done first before running any of the mentioned jobs. The order of the jobs should also be run as shown below. They can be run in parallel to speed up the execution.

**Build and Deploy for Sunbird**

| Service to be Build                         | Build Tag           | Service to Deploy                        | Deploy Tag                                                                             | Comments                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| ------------------------------------------- | ------------------- | ---------------------------------------- | -------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
|                                             |                     | Deploy/Kubernetes/UploadSchema           | release-5.2.0\_RC3                                                                     | Deploy this before deploying the service and flink-jobs.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|                                             |                     | Deploy/KnowledgePlatform/KafkaSetup      | release-5.2.0\_RC8                                                                     | Deploy this before deploying flink-jobs.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| Build/KnowledgePlatform/SyncTool            | release-5.2.0\_RC8  |                                          |                                                                                        | **migratecspdata** - **** Add this command to the command list in the Deploy/KnowledgePlatform/Neo4jElasticSearchSyncTool Jenkins job.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| Build/Core/Content                          | release-5.2.0\_RC3  | Deploy/Kubernetes/Content                | release-5.1.0\_RC5                                                                     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| Build/Core/Taxonomy                         | release-5.2.0\_RC3  | Deploy/Kubernetes/Taxonomy               | release-5.1.0\_RC5                                                                     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| Build/Core/Dial                             | release-5.2.0\_RC1  | Deploy/Kubernetes/Dial                   | release-5.1.0\_RC5                                                                     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| Build/KnowledgePlatform/Learning            | elease-5.2.0\_RC8r  | Deploy/KnowledgePlatform/Learning        | release-5.1.0\_RC5                                                                     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| Build/Core/DiscussionsMW                    | release-5.2.0\_RC1  | Deploy/Kubernetes/DiscussionsMW          | release-5.1.0\_RC5                                                                     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| Build/KnowledgePlatform/FlinkJobs           | release-5.2.0\_RC9  | Deploy/KnowledgePlatform/FlinkJobs       | release-5.2.0\_RC8                                                                     | <p>Add the below job list to the <em>job_names_to_deploy</em> list in the Deploy/KnowledgePlatform/FlinkJobs jenkins job</p><p><strong>csp-migrator,</strong> </p><p><strong>live-node-publisher,</strong> </p><p><strong>live-video-stream-generator,</strong> </p><p><strong>cassandra-data-migration</strong> </p><p></p><p>Deploy the </p><p><strong>assessment-enrichment</strong>, </p><p><strong>content-publish</strong>, </p><p><strong>qrcode-image-generator</strong>, <strong>search-indexer</strong>, </p><p><strong>csp-migrator,</strong> </p><p><strong>live-node-publisher,</strong> </p><p><strong>live-video-stream-generator,</strong> </p><p><strong>cassandra-data-migration</strong> flink jobs. </p> |
|                                             |                     | Deploy/Kubernetes/InquiryUploadSchema    | schema\_repo\_branch\_or\_tag: release-5.2.0\_RC2 source\_folder: question,questionset | Create jenkins jobs from [config](https://github.com/Sunbird-inQuiry/inquiry-api-service/tree/release-5.2.0/scripts/jenkins-jobs/Deploy/Kubernetes/InquiryUploadSchema)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| Build/Core/Assessment                       | release-5.2.0\_RC3  | Deploy/Kubenetes/Assessment              | release-5.1.0\_RC4                                                                     | Update build and deploy job config, [job-config](https://github.com/Sunbird-inQuiry/inquiry-api-service/tree/release-5.2.0/scripts/jenkins-jobs)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| Build/job/KnowledgePlatform/InquiryFlinkJob | elease-5.2.0\_RC3r  | Deploy/KnowledgePlatform/InquiryFlinkJob | release-5.2.0\_RC3                                                                     | create build, deploy and artifactupload jobs, [job-config](https://github.com/Sunbird-inQuiry/inquiry-api-service/tree/release-5.2.0/scripts/jenkins-jobs)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| Build/Core/Learner                          | release-5.0.1\_RC1  | Deploy/Kubernetes/Learner                | release-5.1.0\_RC5                                                                     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| Build/Core/Lms                              | release-5.0.1\_RC2  | Deploy/Kubernetes/Lms                    | release-5.1.0\_RC5                                                                     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| Build/Core/Cert                             | release-5.1.0\_RC1  | Deploy/Kubernetes/Cert                   | release-5.1.0\_RC5                                                                     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| Build/Lern/LernDataProducts                 | release-5.0.1\_RC2  | Deploy/Lern/LernDataProducts             | release-5.1.0\_RC1                                                                     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| Build/Lern/LernFlinkJobs                    | release-5.0.01RC2   | Deploy/Lern/LernFlinkJobs                | release-5.1.0\_RC1                                                                     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| Build/Plugins/ContentEditor                 | release-5.2.0\_RC1  | Deploy/Plugins/ContentEditor             | release-5.1.0\_RC5                                                                     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| Build/Plugins/ContentPlugins                | release-5.2.0\_RC1  | Deploy/Plugins/ContentPlugins            | release-5.0.0\_RC5                                                                     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| Build/Plugins/GenericEditor                 | release-5.2.0\_RC1  | Deploy/Plugins/GenericEditor             | release-5.0.0\_RC5                                                                     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| Build/Core/Player                           | release-5.1.0\_RC30 | Deploy/Kubernetes/Player                 | release-5.1.0\_RC5                                                                     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|                                             |                     | <p>Deploy/Kubernetes/OnboardAPI<br></p>  | release-5.1.0\_RC5                                                                     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|                                             |                     | Deploy/Kubernetes/OnboardConsumers       | release-5.1.0\_RC5                                                                     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|                                             |                     | Deploy/Kubernetes/nginx-public-ingress   | release-5.1.0\_RC5                                                                     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| Build/Core/Analytics                        | release-5.1.0\_RC2  | Deploy/Kubernetes/Analytics              | release-5.1.0\_RC3                                                                     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |

****

**Variables to update**

| variable name                             | value/description                                                                                                                                                                                                                                                      |
| ----------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| cloudstorage\_replace\_absolute\_path     | 'true'  #add in core/common.yml                                                                                                                                                                                                                                        |
| cloudstorage\_base\_path                  | storage url. ex: "https://storagename.blob.core.windows.net"                                                                                                                                                                                                           |
| valid\_cloudstorage\_base\_urls           | storage url. ex:'\["https://storagename.blob.core.windows.net"]'                                                                                                                                                                                                       |
| cloudstorage\_relative\_path\_prefix      | CONTENT\_STORAGE\_BASE\_PATH                                                                                                                                                                                                                                           |
| cloudstorage\_metadata\_list              | \["appIcon","posterImage","artifactUrl","downloadUrl","variants","previewUrl","pdfUrl"]                                                                                                                                                                                |
| cloud\_public\_storage\_accountname       |                                                                                                                                                                                                                                                                        |
| cloud\_public\_storage\_secret            |                                                                                                                                                                                                                                                                        |
| cloud\_public\_storage\_endpoint          |                                                                                                                                                                                                                                                                        |
| cloud\_storage\_content\_bucketname       |                                                                                                                                                                                                                                                                        |
| cloud\_storage\_base\_url                 | storage url. ex: "https://storagename.blob.core.windows.n                                                                                                                                                                                                              |
| lern variables to be updated in inventory | [https://lern.sunbird.org/use/release-notes/release-v-5.0.1#ansible-changes-need-to-be-updated-in-common.yml-secrets.yml-hosts.yml](https://lern.sunbird.org/use/release-notes/release-v-5.0.1#ansible-changes-need-to-be-updated-in-common.yml-secrets.yml-hosts.yml) |



### Add below variables for Core,KnowledgePlatform and Datapipeline inventory

```
// ###### common.yml ###############

cloud_service_provider: 

cloud_public_storage_accountname: ""
cloud_public_storage_endpoint: ""
cloud_public_storage_region: ""
cloud_public_storage_project: ""

cloud_private_storage_accountname: ""
cloud_private_storage_endpoint: ""
cloud_private_storage_region: ""
cloud_private_storage_project: ""

cloud_management_storage_accountname: ""
cloud_management_storage_endpoint: ""
cloud_management_storage_region: ""
cloud_management_storage_project: ""

cloud_artifact_storage_accountname: ""
cloud_artifact_storage_endpoint: ""
cloud_artifact_storage_region: ""
cloud_artifact_storage_project: ""

cloud_storage_certqr_bucketname: "certqr"
cloud_storage_chatbot_bucketname: "chatbot"
cloud_storage_dial_bucketname: "dial"
cloud_storage_flink_bucketname: "flink-state-backend"
cloud_storage_playercdn_bucketname: "player"
cloud_storage_public_bucketname: "public"
cloud_storage_publicreports_bucketname: "public-reports"
cloud_storage_privatereports_bucketname: "reports"
cloud_storage_samiksha_bucketname: "samiksha"
cloud_storage_schema_bucketname: "schema"
cloud_storage_sourcing_bucketname: "sourcing"
cloud_storage_offlineinstaller_bucketname: "{{env}}-offlineinstaller"
cloud_storage_content_bucketname: "sunbird-content-{{env}}"
cloud_storage_telemetry_bucketname: "telemetry-data-store"
cloud_storage_termsandcondtions_bucketname: "termsandcondtions"
cloud_storage_user_bucketname: "user"
cloud_storage_desktopappcrashlogs_bucketname: "desktopappcrashlogs"
cloud_storage_label_bucketname: "label"
cloud_storage_certservice_bucketname: "{{env}}-e-credentials"
cloud_storage_uci_bucketname: "uci-staging"
cloud_storage_cassandrabackup_bucketname: "cassandra-backup"
cloud_storage_dpcassandrabackup_bucketname: "dp-cassandra-backup"
cloud_storage_dppostgresbackup_bucketname: "dp-postgresql-backup"
cloud_storage_dpredisbackup_bucketname: "dp-redis-backup"
cloud_storage_esbackup_bucketname: "elasticsearch-snapshots"
cloud_storage_influxdbbackup_bucketname: "influxdb-backup"
cloud_storage_jenkinsbackup_bucketname: "jenkins-backup"
cloud_storage_mongobackup_bucketname: "mongodb-backup"
cloud_storage_neo4jbackup_bucketname: "neo4j-backup"
cloud_storage_redisbackup_bucketname: "redis-backup"
cloud_storage_artifacts_bucketname: "{{ artifacts_container }}"

########## secrets.yml ###############
cloud_public_storage_secret: ""
cloud_private_storage_secret: ""
cloud_management_storage_secret: ""
cloud_artifact_storage_secret: ""
```



**Migrations**

| Services           | Instructions                                                                                                                                                                                                                                   |
| ------------------ | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Knowlg migrations  | [https://knowlg.sunbird.org/learn/product-and-developer-guide/other/data-migration](https://knowlg.sunbird.org/learn/product-and-developer-guide/other/data-migration)                                                                         |
| Inquiry migrations | [https://project-sunbird.atlassian.net/wiki/spaces/SBDES/pages/3259105331/inQuiry+CSP+migration+verification+steps](https://project-sunbird.atlassian.net/wiki/spaces/SBDES/pages/3259105331/inQuiry+CSP+migration+verification+steps)         |
| lern migration     | [https://lern.sunbird.org/use/release-notes/release-v-5.0.1#data-migrations-run-these-scripts-after-service-deployment](https://lern.sunbird.org/use/release-notes/release-v-5.0.1#data-migrations-run-these-scripts-after-service-deployment) |



**Vdn Deployments and migration**

[https://cokreat.sunbird.org/use/release-notes/cokreat-release-v5.1.0-upcoming-release#jenkins-jobs](https://cokreat.sunbird.org/use/release-notes/cokreat-release-v5.1.0-upcoming-release#jenkins-jobs)
